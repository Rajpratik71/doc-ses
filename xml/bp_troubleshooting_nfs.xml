<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="bp-troubleshooting-nfs">
 <title>Troubleshooting &ganesha;</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:editurl>https://github.com/SUSE/doc-ses/edit/master/xml/</dm:editurl>
   <dm:translation>yes</dm:translation>
   <dm:release>SES 7</dm:release>
  </dm:docmanager>
 </info>
 <sect1 xml:id="bp-troubleshooting-debug-logging">
   <title>Logging</title>
   <para>
     &ganesha; has the following log levels: <literal>NULL</literal>,
     <literal>FATAL</literal>, <literal>MAJ</literal>, <literal>CRIT</literal>,
     <literal>WARN</literal>, <literal>EVENT</literal>, <literal>INFO</literal>,
     <literal>DEBUG</literal>, <literal>MID_DEBUG</literal>, <literal>M_DBG</literal>,
     <literal>FULL_DEBUG</literal> and <literal>F_DBG</literal>.
   </para>
   <para>
     Find the logs by running the following command:
   </para>
<screen>&prompt.cephuser;cephadm logs --name nfs.<replaceable>SERVICE_ID</replaceable>.<replaceable>hostname</replaceable></screen>
   <sect2 xml:id="troubleshooting-set-log-level">
     <title>Setting the Log Level</title>
     <para>
       You change the default debug level by ....., and replacing with ...
     </para>
     <para>
       To debug logging, change the log level to <literal>FULL_DEBUG</literal>
       to increase the log verbosity. Keep in mind that this can produce
       large amounts of data in journalctl and adversely affect performance.
     </para>
   </sect2>
 </sect1>
 <sect1 xml:id="bp-troubleshooting-default-port">
   <title>Change Default Port</title>
   <para>
     To change the default port for &ganesha; you can use a &rados; configuration
     object and configure an &ganesha; parameter.
   </para>
   <para>
     For example, set the port number to the port you want to change. This
     example uses port 12345.
   </para>
<screen>
  NFS_CORE_PARAM { ​
  Enable_NLM = false; ​
  Enable_RQUOTA = false; ​
  Protocols = 4; ​
  NFS_Port = 12345; ​
  }​
</screen>
   <para>
     Put the file into &rados;. In this example, the file is named
     <filename>userconf-nfs.foo</filename>:
   </para>
<screen>
%url "rados://nfs-ganesha/foo/export-1" ​
%url "rados://nfs-ganesha/foo/userconf-nfs.foo" ​
</screen>
   <para>
     Add a reference to the parameter in your &rados; common configuration file:
   </para>
<screen>&prompt.cephuser;rados --pool nfs-ganesha --namespace foo put userconf-nfs.foo userconf-nfs.foo​
&prompt.cephuser;rados --pool nfs-ganesha --namespace foo put conf-nfs.foo conf-nfs.foo​
</screen>
   <note>
     <para>
       This action is similar to how exports are included in the common configuration
       file.
     </para>
   </note>
   <para>
     Once this action is complete, include both configuration objects in the
     &raods; recovery pool and restart the &ceph; orchestrator.
   </para>
<screen>
&prompt.cephuser;ceph orch restart nfs.foo ​
restart nfs.foo.node1 from host 'node1' ​
restart nfs.foo.node3 from host 'node3'
</screen>
 </sect1>
 </chapter>
