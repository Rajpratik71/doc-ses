<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="admin_ds_backup.xml" version="5.0" xml:id="cha-deployment-backup">
 <title>Copia de seguridad de la configuración del clúster</title>
 <info>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:maintainer>tbazant@suse.com</dm:maintainer>
        <dm:status>editar</dm:status>
        <dm:deadline/>
        <dm:priority/>
        <dm:translation>sí</dm:translation>
        <dm:languages/>
        <dm:release>SES 5</dm:release>
      </dm:docmanager>
    </info>
    <para>
  Este capítulo explica de qué archivos del nodo de administración se debe realizar una copia de seguridad. En cuanto termine con la distribución o la migración del clúster, cree una copia de seguridad de estos directorios.
 </para>
 <sect1 xml:id="sec-deployment-backup-salt">
  <title>Copia de seguridad de la configuración de Salt</title>

  <para>
   Se puede realizar una copia de seguridad del directorio <filename>/etc/salt/</filename>. Contiene los archivos de configuración de Salt, por ejemplo la clave maestra de Salt y las claves de cliente aceptadas.
  </para>

  <para>
   No es estrictamente necesario incluir los archivos de Salt al realizar una copia de seguridad del nodo de administración, pero facilita la posterior redistribución del clúster de Salt. Si no se hace una copia de seguridad de estos archivos, los minions de Salt deben registrarse de nuevo en el nuevo nodo de administración.
  </para>

  <note>
   <title>seguridad de la clave privada de master de Salt</title>
   <para>
    Asegúrese de que la copia de seguridad de la clave privada del master de Salt se guarda en una ubicación segura. La clave del master de Salt puede emplearse para manipular todos los nodos del clúster.
   </para>
  </note>

  <para>
   Después de restaurar el directorio <filename>/etc/salt</filename> desde una copia de seguridad, reinicie los servicios de Salt:
  </para>

<screen><prompt>root@master # </prompt><command>systemctl</command> restart salt-master
<prompt>root@master # </prompt><command>systemctl</command> restart salt-minion</screen>
 </sect1>
 <sect1 xml:id="sec-deployment-backup-deepsea">
  <title>Copia de seguridad de la configuración de DeepSea</title>

  <para>
   Todos los archivos requeridos por DeepSea se almacenan en <filename>/srv/pillar/</filename>, en <filename>/srv/salt/</filename> y en <filename>/etc/salt/master.d</filename>.
  </para>

  <para>
   Si necesita volver a distribuir el nodo de administración, instale el paquete de DeepSea en el nodo nuevo y mueva los datos copiados de vuelta a los directorios. DeepSea puede usarse de nuevo sin realizar más cambios. Antes de volver a utilizar DeepSea, asegúrese de que todos los minions de Salt están registrados correctamente en el nodo de administración.
  </para>
 </sect1>
</chapter>
