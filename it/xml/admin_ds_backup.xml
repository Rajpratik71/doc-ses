<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="admin_ds_backup.xml" version="5.0" xml:id="cha-deployment-backup">
 <title>Backup della configurazione del cluster</title>
 <info>
      <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
        <dm:maintainer>tbazant@suse.com</dm:maintainer>
        <dm:status>modifica</dm:status>
        <dm:deadline/>
        <dm:priority/>
        <dm:translation>sì</dm:translation>
        <dm:languages/>
        <dm:release>SES 5</dm:release>
      </dm:docmanager>
    </info>
    <para>
  Questo capitolo spiega per quali file del nodo admin occorre eseguire il backup. Non appena si completa la migrazione o la distribuzione del cluster, creare un backup di queste directory.
 </para>
 <sect1 xml:id="sec-deployment-backup-salt">
  <title>Backup della configurazione Salt</title>

  <para>
   È possibile eseguire il backup della directory <filename>/etc/salt/</filename>, contenente i file di configurazione Salt, ad esempio la chiave Salt master e le chiavi del client accettate.
  </para>

  <para>
   I file Salt non sono strettamente richiesti per il backup del nodo admin, ma semplificano la ridistribuzione del cluster Salt. Se non esiste alcun backup di tali file, i Salt minion devono essere nuovamente registrati nel nuovo nodo admin.
  </para>

  <note>
   <title>sicurezza della chiave privata del Salt master</title>
   <para>
    Verificare che il backup della chiave privata del Salt master sia memorizzato in un'ubicazione sicura. La chiave del Salt master può essere utilizzata per gestire tutti i nodi del cluster.
   </para>
  </note>

  <para>
   Dopo il ripristino della directory <filename>/etc/salt</filename> da un backup, riavviare i servizi Salt:
  </para>

<screen><prompt>root@master # </prompt><command>systemctl</command> restart salt-master
<prompt>root@master # </prompt><command>systemctl</command> restart salt-minion</screen>
 </sect1>
 <sect1 xml:id="sec-deployment-backup-deepsea">
  <title>Backup della configurazione DeepSea</title>

  <para>
   Tutti i file richiesti da DeepSea sono memorizzati in <filename>/srv/pillar/</filename>, <filename>/srv/salt/</filename> e <filename>/etc/salt/master.d</filename>.
  </para>

  <para>
   Se occorre ridistribuire il nodo admin, installare il pacchetto DeepSea sul nuovo nodo e spostare i dati di backup nelle directory. È quindi possibile utilizzare di nuovo DeepSea senza ulteriori modifiche. Prima di riutilizzare DeepSea, verificare che tutti i Salt minion siano registrati correttamente sul nodo admin.
  </para>
 </sect1>
</chapter>
